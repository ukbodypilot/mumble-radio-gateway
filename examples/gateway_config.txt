# ============================================================================
# MUMBLE RADIO GATEWAY - CONFIGURATION FILE
# ============================================================================
# 
# This file configures the Mumble-to-Radio gateway via AIOC.
# All parameters have safe defaults and detailed explanations.
# 
# Quick Start:
#   1. Set MUMBLE_SERVER to your server IP
#   2. Adjust VERBOSE_LOGGING (true for diagnostics, false for quiet operation)
#   3. Most other settings can stay at defaults
#
# Keyboard Controls (runtime adjustments without restarting):
#   MUTE:    't' = TX | 'r' = RX | 'm' = Global mute/unmute
#   AUDIO:   'v' = VAD toggle | ',' = Volume down | '.' = Volume up
#   PROCESS: 'n' = Noise gate | 'f' = High-pass filter | 'a' = AGC
#            's' = Spectral suppression | 'w' = Wiener suppression
#            'e' = Echo cancellation | 'x' = Stream health on/off
#   PTT:     'p' = Manual PTT toggle (override auto-PTT)
#
# For troubleshooting, see the diagnostic sections at the bottom.
# ============================================================================

# ============================================================================
# MUMBLE SERVER CONNECTION
# ============================================================================

# Mumble server IP address or hostname
# Example: 192.168.1.100 or mumble.example.com
MUMBLE_SERVER = 192.168.2.128

# Mumble server port
# Default: 64738 (standard Mumble port)
MUMBLE_PORT = 64738

# Username to display on the Mumble server
# This name will be visible to other Mumble users
MUMBLE_USERNAME = RadioGateway

# Password for the Mumble server
# Leave empty if no password required
MUMBLE_PASSWORD = 

# Channel to join on connection
# Leave empty to stay in root channel
# Example: General/Radio or just Radio
MUMBLE_CHANNEL = 

# ============================================================================
# AUDIO QUALITY & BUFFER SETTINGS
# ============================================================================

# Audio sample rate in Hz
# 48000 = CD quality (matches Mumble default, recommended)
# 24000 = Good quality (lower bandwidth)
# 16000 = Basic quality
# 8000  = Phone quality (minimal bandwidth)
# Default: 48000
AUDIO_RATE = 48000

# Audio chunk size in samples (CRITICAL FOR STABILITY)
# Controls latency vs stability tradeoff
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Samples â”‚ Latency â”‚ Use Case                     â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚  480    â”‚  10ms   â”‚ Lowest latency (may dropout) â”‚
# â”‚  960    â”‚  20ms   â”‚ Low latency                  â”‚
# â”‚ 1920    â”‚  40ms   â”‚ Balanced                     â”‚
# â”‚ 2400    â”‚  50ms   â”‚ Stable                       â”‚
# â”‚ 4800    â”‚ 100ms   â”‚ High stability               â”‚
# â”‚ 9600    â”‚ 200ms   â”‚ Maximum stability (default)  â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# Larger values = smoother file playback, more latency
# If you get -9999 errors, increase this value
# Default: 9600 (200ms buffer for smooth file playback)
AUDIO_CHUNK_SIZE = 9600

# Number of audio channels
# 1 = Mono (recommended for radio)
# 2 = Stereo (not needed for radio)
AUDIO_CHANNELS = 1

# Audio bit depth
# 16 = Standard (recommended, don't change)
# 24 = Higher quality (rarely needed)
AUDIO_BITS = 16

# ============================================================================
# MUMBLE AUDIO CODEC SETTINGS
# ============================================================================

# Mumble audio quality (bitrate in bits per second)
# Note: This is informational - actual bitrate is controlled by Mumble's codec
# Higher = better quality but more bandwidth
# 40000 = high quality, 72000 = very high, 96000 = maximum
# Recommended: 72000 for radio use
MUMBLE_BITRATE = 72000

# Enable/disable Opus codec VBR (Variable Bit Rate)
# true = adapts bitrate based on audio complexity (recommended)
# false = constant bitrate
MUMBLE_VBR = true

# Mumble jitter buffer size in milliseconds
# Lower = less latency but may cause audio dropouts on poor networks
# Higher = more latency but smoother audio
# Recommended: 10-20ms for LAN, 30-50ms for internet
MUMBLE_JITTER_BUFFER = 20

# ============================================================================
# PTT (PUSH-TO-TALK) CONTROL - Mumble â†’ Radio
# ============================================================================

# AIOC PTT channel selection
# 3 = PTT1 (usually front panel connector)
# 4 = PTT2 (usually rear panel connector)
# Default: 3
AIOC_PTT_CHANNEL = 3

# PTT release delay (seconds)
# How long to hold PTT after Mumble audio stops
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Value   â”‚ Effect                         â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ 0.1-0.2 â”‚ Fast release (may clip end)    â”‚
# â”‚ 0.3-0.5 â”‚ Balanced (recommended)         â”‚
# â”‚ 0.6-1.0 â”‚ Long tail (prevents clipping)  â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# Too short = cuts off end of transmissions
# Too long = delayed return to receive mode
# Note: Not used when Manual PTT mode is active (press 'p' key)
# Default: 0.3
PTT_RELEASE_DELAY = 0.3

# PTT activation delay (seconds)
# Delay before keying PTT when Mumble audio arrives
# Allows radio to settle before transmitting
# Most radios: 0.0 (immediate)
# Slow radios: 0.05-0.1 (if radio needs setup time)
# Default: 0.0
PTT_ACTIVATION_DELAY = 0.0

# ============================================================================
# AIOC DEVICE SETTINGS
# ============================================================================

# AIOC USB Vendor ID (don't change unless using different device)
AIOC_VID = 0x1209

# AIOC USB Product ID (don't change unless using different device)
AIOC_PID = 0x7388

# Force specific audio device index (leave as -1 for auto-detect)
# Use -1 to automatically find AIOC audio device
# Or specify device index number if auto-detect fails
AIOC_INPUT_DEVICE = -1
AIOC_OUTPUT_DEVICE = -1

# ============================================================================
# AUDIO PROCESSING SETTINGS
# ============================================================================

# Enable automatic gain control (AGC)
# Automatically adjusts input volume levels
# Recommended: false for radio (radio has its own gain control)
ENABLE_AGC = false

# Enable noise suppression on Radioâ†’Mumble path
# Reduces background noise and hiss from radio RF before sending to Mumble
# Recommended: true to clean up noisy radio audio
ENABLE_NOISE_SUPPRESSION = false

# Noise suppression method: spectral, wiener, or none
# spectral = Spectral subtraction (built-in, fast, good quality)
# wiener = Wiener filtering (more aggressive, may affect voice)
# none = Disable (use if you have external processing)
# Recommended: spectral
NOISE_SUPPRESSION_METHOD = none

# Noise suppression strength (0.0 to 1.0)
# Higher = more aggressive noise removal but may affect voice quality
# 0.3 = light (preserve voice quality)
# 0.5 = moderate (balanced)
# 0.7 = strong (aggressive noise removal)
# Recommended: 0.5 to 0.7 for noisy radio signals
NOISE_SUPPRESSION_STRENGTH = 0.6

# Enable noise gate on Radioâ†’Mumble path
# Mutes audio below a threshold to eliminate radio hiss/static
# Recommended: true for cleaner Mumble transmission
ENABLE_NOISE_GATE = false

# Noise gate threshold in dB (-60 to 0)
# Radio audio quieter than this will be muted
# -40 = only very quiet noise filtered
# -30 = moderate filtering  
# -20 = aggressive filtering (may cut weak radio signals)
# Recommended: -35 to -30 for radio
NOISE_GATE_THRESHOLD = -32

# Noise gate attack time in milliseconds
# How quickly gate opens when signal exceeds threshold
# Lower = more responsive but may click
# Recommended: 5 to 20ms
NOISE_GATE_ATTACK = 10

# Noise gate release time in milliseconds  
# How quickly gate closes when signal drops below threshold
# Lower = faster cutoff but may sound choppy
# Higher = smoother but may let more noise through
# Recommended: 50 to 200ms
NOISE_GATE_RELEASE = 100

# Enable high-pass filter on Radioâ†’Mumble path
# Removes low-frequency rumble, hum, and handling noise
# Strongly recommended for radio use
ENABLE_HIGHPASS_FILTER = false

# High-pass filter cutoff frequency in Hz
# Audio below this frequency is attenuated
# 80 = Very gentle (keeps more bass)
# 120 = Moderate (recommended for radio)
# 200 = Aggressive (removes more low end)
# Default: 120
HIGHPASS_CUTOFF_FREQ = 120

# Enable echo cancellation (EXPERIMENTAL)
# Attempts to remove echo/feedback between radio RX and TX
# May affect audio quality - only enable if you have echo problems
# Recommended: false (most radios don't need this)
ENABLE_ECHO_CANCELLATION = false

# ============================================================================
# VOLUME CONTROL
# ============================================================================

# Input volume multiplier (Radio â†’ Mumble)
# Adjusts volume of radio audio going TO Mumble
# Can also adjust at runtime with ',' and '.' keys
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Value   â”‚ Effect                         â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ 0.5     â”‚ Quieter (50% volume)           â”‚
# â”‚ 1.0     â”‚ Normal (no change)             â”‚
# â”‚ 1.5     â”‚ Louder (150% volume)           â”‚
# â”‚ 2.0+    â”‚ Much louder (may distort)      â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# Recommended: 0.8 to 1.2
INPUT_VOLUME = 1.0

# Output volume multiplier (Mumble â†’ Radio)
# Adjusts volume of Mumble audio going TO radio
# Range: 0.1 to 3.0
# Recommended: 0.8 to 1.2
OUTPUT_VOLUME = 1.0

# ============================================================================
# NETWORK & CONNECTION SETTINGS
# ============================================================================

# Network connection timeout in seconds
# How long to wait for network operations before giving up
# Default: 10
NETWORK_TIMEOUT = 10

# Enable TCP no-delay (Nagle's algorithm disable)
# Reduces network latency by sending packets immediately
# Recommended: true for real-time voice
TCP_NODELAY = true

# Enable Mumble loop rate (seconds)
# How often the Mumble library processes events
# Lower = more responsive but more CPU
# Default: 0.01 (100 Hz)
MUMBLE_LOOP_RATE = 0.02

# Enable Mumble stereo mode
# true = stereo audio, false = mono
# Recommended: false for radio (radio is mono)
MUMBLE_STEREO = false

# Auto-reconnect to Mumble on disconnect
# true = automatically reconnect if connection lost
# false = exit on disconnect
# Recommended: true for unattended operation
MUMBLE_RECONNECT = true

# Enable Mumble debug messages
# Shows detailed Mumble protocol information
# Only enable if troubleshooting Mumble connection issues
MUMBLE_DEBUG = false

# ============================================================================
# LOGGING & STATUS DISPLAY
# ============================================================================

# Enable verbose logging
# true = Show detailed diagnostic messages
# false = Quiet operation (only errors and status line)
# Recommended: true for setup/troubleshooting, false for production
VERBOSE_LOGGING = false

# Status update interval (seconds)
# How often to refresh the status line showing:
#   [Status] M:âœ“ PTT:-- VAD:-- -45dB TX:[--] RX:[--]
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Value   â”‚ Effect                       â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ 0       â”‚ No status updates            â”‚
# â”‚ 1-2     â”‚ Fast updates (more CPU)      â”‚
# â”‚ 3-5     â”‚ Balanced (recommended)       â”‚
# â”‚ 10+     â”‚ Slow updates (less CPU)      â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# Default: 5
STATUS_UPDATE_INTERVAL = 5

# ============================================================================
# BUFFER MANAGEMENT SETTINGS
# ============================================================================

# Maximum Mumble output buffer size in seconds
# If buffer exceeds this, audio chunks are dropped to prevent delay buildup
# Lower = tighter latency but may drop more audio
# Higher = more tolerance but may accumulate delay
# 0 = disable buffer management (NOT recommended - delay will grow over time)
# Recommended: 1.5 to 3 seconds
MAX_MUMBLE_BUFFER_SECONDS = 1.0

# Enable buffer management diagnostics
# Shows when audio chunks are dropped due to buffer being full
# Recommended: true to understand if delay is being managed
BUFFER_MANAGEMENT_VERBOSE = false

# ============================================================================
# VOICE ACTIVITY DETECTION (VAD) - Radio â†’ Mumble
# ============================================================================
# VAD prevents sending silence to Mumble, which:
#   â€¢ Eliminates buffer accumulation and delay buildup
#   â€¢ Reduces bandwidth by ~90% (only sends active transmissions)
#   â€¢ Provides cleaner audio (no constant noise floor)
#   â€¢ Prevents Mumble users from hearing continuous static

# Enable Voice Activity Detection
# true  = Only send audio when radio signal detected (HIGHLY RECOMMENDED)
# false = Send continuous audio stream (will cause buffer issues)
# Default: true
ENABLE_VAD = true

# VAD threshold (dB)
# Audio quieter than this is considered silence
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Value   â”‚ Behavior                         â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ -45     â”‚ Very sensitive (may send noise)  â”‚
# â”‚ -40     â”‚ Sensitive                        â”‚
# â”‚ -35     â”‚ Moderate (recommended)           â”‚
# â”‚ -30     â”‚ Less sensitive                   â”‚
# â”‚ -25     â”‚ Only strong signals              â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# Tune this while watching the status line dB reading
# Default: -33
VAD_THRESHOLD = -33

# VAD attack time (milliseconds)
# How quickly VAD opens when signal appears
# Lower = more responsive, Higher = smoother
# Range: 10-50ms
# Default: 20
VAD_ATTACK = 20

# VAD release time (milliseconds)
# How long to keep transmitting after signal drops
# Prevents cutting off the end of transmissions
# Range: 200-500ms
# Default: 300
VAD_RELEASE = 300

# VAD minimum transmission duration (milliseconds)
# Ignores very short bursts (static pops, clicks)
# Range: 100-300ms
# Default: 150
VAD_MIN_DURATION = 150

# ============================================================================
# STREAM HEALTH MANAGEMENT (USB/ALSA Stability)
# ============================================================================
# The AIOC uses a CM108 chipset which has known ALSA driver issues.
# Proactive stream restarts prevent the dreaded "-9999 Unanticipated host error"
# Restarts only occur when the radio is idle (no active transmission)

# Enable automatic stream health management
# true  = Proactively restart streams to prevent -9999 errors
# false = Only restart on actual errors (default, recommended for stable systems)
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Value â”‚ When to Use                          â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ false â”‚ Stable systems, no -9999 errors     â”‚
# â”‚ true  â”‚ Experiencing -9999 errors or freezesâ”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# You can toggle this at runtime with the 'x' key
# Default: false
ENABLE_STREAM_HEALTH = false

# Proactive stream restart interval (seconds)
# Periodically restarts the audio stream to prevent crashes
# Only used when ENABLE_STREAM_HEALTH = true
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Value   â”‚ Effect                         â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ 0       â”‚ Disabled (uses error-based only)â”‚
# â”‚ 30      â”‚ Very safe (more interruptions) â”‚
# â”‚ 60      â”‚ Balanced (recommended)         â”‚
# â”‚ 120     â”‚ Less safe (fewer interruptions)â”‚
# â”‚ 300     â”‚ Minimal (for stable systems)   â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# Default: 60 (when enabled)
STREAM_RESTART_INTERVAL = 60

# Minimum idle time before allowing restart (seconds)
# Prevents restarting during active transmissions
# Radio must be silent for this long before restart occurs
# Range: 3-10 seconds
# Default: 3
STREAM_RESTART_IDLE_TIME = 3

# ============================================================================
# VOX (VOICE OPERATED SWITCH) SETTINGS - Radio â†’ Mumble
# ============================================================================

# Enable VOX for Radio â†’ Mumble transmission
# When enabled, audio is only sent to Mumble when radio is receiving a signal
# This prevents sending constant silence and eliminates buffer accumulation
# Recommended: true (eliminates most buffer issues)
ENABLE_VOX = true

# VOX threshold in dB
# Audio louder than this triggers transmission to Mumble
# Lower = more sensitive (may transmit on noise)
# Higher = less sensitive (may miss weak signals)
# -50 = very sensitive (picks up background noise)
# -40 = moderate (good for most radios)
# -30 = less sensitive (only strong signals)
# Recommended: -40 to -35
VOX_THRESHOLD = -40

# VOX attack time in milliseconds
# How quickly VOX activates when signal detected
# Lower = faster response but may click
# Recommended: 20 to 100ms
VOX_ATTACK_TIME = 50

# VOX release time in milliseconds
# How long to keep transmitting after signal drops below threshold
# Lower = cuts off quickly (may clip end of transmissions)
# Higher = smoother but may transmit extra tail
# Recommended: 300 to 800ms for radio
VOX_RELEASE_TIME = 500

# ============================================================================
# FILE PLAYBACK SETTINGS (Phase 2)
# ============================================================================

# Enable audio file playback
# true  = Allow playing audio files (MP3, OGG, FLAC, M4A, WAV)
# false = Disable file playback
# Requires: pip install soundfile --break-system-packages
#           sudo apt-get install libsndfile1
# Optional: pip install resampy --break-system-packages (better resampling quality)
# Without soundfile: WAV files only (built-in support)
# Default: false
ENABLE_PLAYBACK = true

# Directory containing audio files
# Can be absolute path or relative to script location
# Examples: /home/user/audio/ or ./audio/
# Default: ./audio/
PLAYBACK_DIRECTORY = ./audio/

# Periodic station ID interval in seconds
# How often to automatically play station_id file (key 0)
# The gateway will automatically find station_id.mp3/.wav/.ogg/.flac/.m4a
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ Value   â”‚ Frequency                      â”‚
# â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
# â”‚ 0       â”‚ Disabled (manual only)         â”‚
# â”‚ 300     â”‚ Every 5 minutes                â”‚
# â”‚ 600     â”‚ Every 10 minutes (recommended) â”‚
# â”‚ 1800    â”‚ Every 30 minutes               â”‚
# â”‚ 3600    â”‚ Every hour                     â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
# Note: Announcement only plays when radio is idle (no active VAD)
# Default: 0 (disabled)
PLAYBACK_ANNOUNCEMENT_INTERVAL = 0

# ============================================================================
# FILE PLAYBACK FEATURES (Phase 2)
# ============================================================================
#
# Status Line Indicators:
#   When ENABLE_PLAYBACK=true, ten colored status indicators appear:
#   [0][1][2][3][4][5][6][7][8][9]
#   
#   [0] = station_id (auto-detected, any extension)
#   [1-9] = announcement1-9 (any extension)
#   
#   Colors:
#   â€¢ White  = File not found
#   â€¢ Green  = File ready to play
#   â€¢ Red    = Currently playing/transmitting
#
# Keyboard Controls:
#   '0' = Play station_id (auto-detected)
#   '1' = Play announcement1
#   '2' = Play announcement2
#   '3' = Play announcement3
#   '4' = Play announcement4
#   '5' = Play announcement5
#   '6' = Play announcement6
#   '7' = Play announcement7
#   '8' = Play announcement8
#   '9' = Play announcement9
#
# Audio Routing:
#   â€¢ File playback â†’ Radio TX (with PTT)
#   â€¢ Radio RX â†’ Mumble (as usual)
#   â€¢ When file plays, PTT activates automatically
#   â€¢ File playback at 100% volume (not mixed with radio)
#
# Supported Audio Formats (with soundfile):
#   â€¢ MP3 - Most common, small file size, good quality
#   â€¢ OGG - Open source, small file size
#   â€¢ FLAC - Lossless quality, larger files
#   â€¢ M4A - Apple/AAC format
#   â€¢ WAV - Uncompressed, instant loading, large files
#
# Audio File Requirements:
#   The gateway automatically converts files to the correct format.
#   Original file can be any sample rate, mono/stereo, any bit depth.
#   Gateway converts to: 48000 Hz, Mono, 16-bit
#
# Installing soundfile for multi-format support (Python 3.13 compatible):
#   pip install soundfile --break-system-packages
#   sudo apt-get install libsndfile1
#   pip install resampy --break-system-packages  # Optional, for better quality
#
# Verify installation:
#   python3 -c "import soundfile; print('soundfile works!')"
#
# Directory Structure Example:
#   ./audio/
#     â”œâ”€â”€ announcement1.mp3     # Triggered with '1' key
#     â”œâ”€â”€ announcement2.ogg     # Triggered with '2' key
#     â””â”€â”€ station_id.mp3        # Triggered with '3' key or periodic
#
# How It Works:
#   â€¢ Files are queued and played in order
#   â€¢ Playback triggers PTT automatically
#   â€¢ Radio audio continues to Mumble (RX path)
#   â€¢ File playback goes to radio (TX path)
#   â€¢ Periodic announcements only when radio is idle
#   â€¢ Files are loaded into memory (not streamed)
#   â€¢ All conversion happens automatically at load time
#
# Troubleshooting:
#
#   â€¢ "No module named 'soundfile'":
#     pip install soundfile --break-system-packages
#
#   â€¢ "Error opening file: Format not recognised":
#     sudo apt-get install libsndfile1
#
#   â€¢ White [1][2][3] indicators:
#     Files not found - check file names and paths
#     ls -la ./audio/
#
#   â€¢ File plays but no TX output:
#     Already fixed in Phase 2 - file audio routes to radio TX
#
#   â€¢ File too quiet:
#     Already fixed in Phase 2 - file plays at 100% volume
#
# Creating Compatible Files:
#
#   With soundfile installed, ANY format works! Just drop files in ./audio/
#
#   If you need to convert manually:
#     ffmpeg -i input.mp3 -ar 48000 -ac 1 output.wav
#
#   Using Audacity:
#     File â†’ Export â†’ Export as MP3 or WAV
#     Set to Mono, 48000 Hz
#
#   Text-to-Speech (espeak):
#     espeak -w temp.wav "This is W1XYZ repeater"
#     ffmpeg -i temp.wav -ar 48000 -ac 1 station_id.mp3
#
# Configuration Examples:
#
#   1. Station ID every 10 minutes:
#      ENABLE_PLAYBACK = true
#      PLAYBACK_DIRECTORY = ./audio/
#      PLAYBACK_ANNOUNCEMENT_INTERVAL = 600
#      # Place station_id.mp3 (or .wav/.ogg/.flac/.m4a) in ./audio/
#
#   2. Manual announcements only (no periodic):
#      ENABLE_PLAYBACK = true
#      PLAYBACK_ANNOUNCEMENT_INTERVAL = 0
#      # Press 0-9 to manually trigger files
#
#   3. Custom directory with multiple announcements:
#      PLAYBACK_DIRECTORY = /home/user/radio_audio/
#      PLAYBACK_ANNOUNCEMENT_INTERVAL = 1800
#      # Files: station_id.ogg, announcement1-9.mp3
#
# Performance:
#   â€¢ Memory: ~50-100 KB per loaded file (uncompressed in RAM)
#   â€¢ CPU: Conversion happens once at load time
#   â€¢ Playback: Zero CPU (just memory copy)
#
# ============================================================================

# ============================================================================
# FILE PLAYBACK USAGE NOTES
# ============================================================================
#
# Supported Audio Formats (with pydub):
#   â€¢ MP3 - Most common, small file size, good quality
#   â€¢ OGG - Open source, small file size
#   â€¢ FLAC - Lossless quality, larger files
#   â€¢ M4A - Apple/AAC format
#   â€¢ WAV - Uncompressed, instant loading, large files
#
# Audio File Requirements:
#   The gateway automatically converts files to the correct format.
#   Original file can be any sample rate, mono/stereo, any bit depth.
#   Gateway converts to: 48000 Hz, Mono, 16-bit
#
# Installing pydub for MP3/OGG/FLAC support:
#   pip install pydub --break-system-packages
#   sudo apt-get install ffmpeg  # Required by pydub
#
# Directory Structure Example:
#   ./audio/
#     â”œâ”€â”€ station_id.mp3        # Key 0 (auto-detected, periodic)
#     â”œâ”€â”€ announcement1.mp3     # Key 1
#     â”œâ”€â”€ announcement2.ogg     # Key 2
#     â”œâ”€â”€ announcement3.wav     # Key 3
#     â”œâ”€â”€ announcement4.flac    # Key 4
#     â”œâ”€â”€ announcement5.m4a     # Key 5
#     â”œâ”€â”€ announcement6.mp3     # Key 6
#     â”œâ”€â”€ announcement7.wav     # Key 7
#     â”œâ”€â”€ announcement8.ogg     # Key 8
#     â””â”€â”€ announcement9.mp3     # Key 9
#
# Keyboard Controls (during operation):
#   '0' = Play station_id (auto-detected, any extension)
#   '1' = Play announcement1 (any extension)
#   '2' = Play announcement2
#   '3' = Play announcement3
#   '4' = Play announcement4
#   '5' = Play announcement5
#   '6' = Play announcement6
#   '7' = Play announcement7
#   '8' = Play announcement8
#   '9' = Play announcement9
#
# How It Works:
#   â€¢ Files are queued and played in order
#   â€¢ Playback triggers PTT automatically
#   â€¢ File playback at full volume (not mixed with radio)
#   â€¢ Radio RX continues to Mumble (separate path)
#   â€¢ Periodic station ID only when radio is idle
#   â€¢ Files are loaded into memory (not streamed)
#
# Creating Compatible Files:
#
#   Using ffmpeg (convert any format):
#     ffmpeg -i input.mp3 -ar 48000 -ac 1 -sample_fmt s16 output.wav
#     ffmpeg -i input.ogg -ar 48000 -ac 1 output.mp3
#
#   Using Audacity:
#     1. File â†’ Export â†’ Export as WAV or MP3
#     2. For WAV: PCM signed 16-bit, 48000 Hz, Mono
#     3. For MP3: 128 kbps or higher, Mono
#
#   Text-to-Speech (espeak):
#     espeak -w temp.wav "This is W1XYZ repeater"
#     ffmpeg -i temp.wav -ar 48000 -ac 1 station_id.mp3
#
# Configuration Examples:
#
#   1. Station ID every 10 minutes (MP3):
#      ENABLE_PLAYBACK = true
#      PLAYBACK_DIRECTORY = ./audio/
#      PLAYBACK_ANNOUNCEMENT_FILE = station_id.mp3
#      PLAYBACK_ANNOUNCEMENT_INTERVAL = 600
#
#   2. Manual announcements only:
#      ENABLE_PLAYBACK = true
#      PLAYBACK_ANNOUNCEMENT_INTERVAL = 0
#      (Press 1, 2, or 3 to play files manually)
#
#   3. Custom directory with OGG files:
#      PLAYBACK_DIRECTORY = /home/user/radio_audio/
#      PLAYBACK_ANNOUNCEMENT_FILE = id.ogg
#      PLAYBACK_ANNOUNCEMENT_INTERVAL = 1800
#
# Troubleshooting:
#
#   â€¢ "File not found":
#     Check PLAYBACK_DIRECTORY path and verify file exists
#     ls -la ./audio/
#
#   â€¢ "MP3 not supported without pydub":
#     Install pydub: pip install pydub --break-system-packages
#     Or convert to WAV: ffmpeg -i file.mp3 -ar 48000 -ac 1 file.wav
#
#   â€¢ No audio output:
#     Check ENABLE_PLAYBACK = true
#     Press keyboard shortcuts (1, 2, 3) to test
#     Check file is in correct directory
#
#   â€¢ Wrong speed or pitch:
#     With pydub: Automatically fixed
#     Without pydub: Convert to 48000 Hz WAV
#
#   â€¢ File too quiet/loud:
#     Adjust in audio editor before using
#     Or normalize: ffmpeg -i in.mp3 -filter:a "volume=0.8" out.mp3
#
# ============================================================================
# TROUBLESHOOTING GUIDE
# ============================================================================
#
# Common Issues and Solutions:
#
# 1. AUDIO DROPOUTS / -9999 ERRORS
#    â€¢ Enable ENABLE_STREAM_HEALTH = true
#    â€¢ Increase AUDIO_CHUNK_SIZE (try 4800)
#    â€¢ Try different USB port
#    â€¢ Check USB power supply
#    â€¢ Press 'x' key at runtime to toggle stream health
#
# 2. DELAY BUILDING UP OVER TIME
#    â€¢ Ensure ENABLE_VAD = true
#    â€¢ Reduce MAX_MUMBLE_BUFFER_SECONDS (try 1.5)
#    â€¢ Check VAD_THRESHOLD is appropriate for your radio
#    â€¢ Watch status line to see if RX shows 0% during silence
#
# 3. CUTTING OFF END OF TRANSMISSIONS
#    â€¢ Increase PTT_RELEASE_DELAY (try 0.5)
#    â€¢ Increase VAD_RELEASE (try 400-500)
#    â€¢ Not applicable in Manual PTT mode (press 'p')
#
# 4. TOO MUCH NOISE GOING TO MUMBLE
#    â€¢ Lower VAD_THRESHOLD (try -30, less sensitive)
#    â€¢ Enable ENABLE_NOISE_GATE = true
#    â€¢ Increase NOISE_GATE_THRESHOLD (try -30)
#    â€¢ Enable ENABLE_HIGHPASS_FILTER = true
#
# 5. MISSING WEAK SIGNALS
#    â€¢ Raise VAD_THRESHOLD (try -38, more sensitive)
#    â€¢ Increase INPUT_VOLUME (press '.' key multiple times)
#    â€¢ Disable or reduce NOISE_GATE_THRESHOLD
#
# 6. MUMBLE USERS COMPLAIN ABOUT AUDIO QUALITY
#    â€¢ Increase MUMBLE_BITRATE (try 96000)
#    â€¢ Check INPUT_VOLUME (should be 0.5-1.5)
#    â€¢ Verify AUDIO_RATE = 48000
#    â€¢ Disable NOISE_SUPPRESSION temporarily to test
#
# 7. PTT NOT WORKING OR STUCK
#    â€¢ If in Manual PTT mode (M-ON/M--), press 'p' to toggle
#    â€¢ Check TX mute status, press 't' to unmute
#    â€¢ Verify AIOC_PTT_CHANNEL matches your AIOC jumper setting
#    â€¢ Check PTT_RELEASE_DELAY isn't too long
#
# 8. MANUAL PTT MODE (NEW FEATURE)
#    â€¢ Press 'p' to manually key/unkey radio
#    â€¢ Status shows M-ON (keyed) or M-- (unkeyed)
#    â€¢ Overrides automatic PTT behavior
#    â€¢ Useful for long transmissions or testing
#
# 9. FILE PLAYBACK NOT WORKING (Phase 2)
#    â€¢ Check ENABLE_PLAYBACK = true in config
#    â€¢ Verify files exist: ls -la ./audio/
#    â€¢ For MP3/OGG: Install pydub (pip install pydub --break-system-packages)
#    â€¢ Press '1', '2', or '3' to manually trigger playback
#    â€¢ Check verbose logging for error messages
#
# 10. PERIODIC ANNOUNCEMENT NOT PLAYING (Phase 2)
#    â€¢ Check PLAYBACK_ANNOUNCEMENT_INTERVAL > 0
#    â€¢ Check PLAYBACK_ANNOUNCEMENT_FILE is set and exists
#    â€¢ Radio must be idle (no active VAD) for announcement to play
#    â€¢ Wait for the interval to elapse (e.g., 600s = 10 minutes)
#
# Status Line Legend:
#   [âœ“/âš /âœ—]   = Audio capture status (ACTIVE/IDLE/STOPPED)
#   M:âœ“/âœ—     = Mumble connected/disconnected
#   PTT:ON/-- = Push-to-talk active/inactive (auto mode)
#   PTT:M-ON/M-- = Manual PTT mode active/inactive (press 'p')
#   VAD:âœ—/ðŸ”Š/-- = VAD disabled/active/silent
#   -XXdB     = Current audio level (tune VAD_THRESHOLD based on this)
#   TX:[bar]  = Mumble â†’ Radio audio level (or [---MUTE---] if muted)
#   RX:[bar]  = Radio â†’ Mumble audio level (or [---MUTE---] if muted)
#   Vol:X.Xx  = RX volume multiplier (adjustable with , and . keys)
#   [N,F,A,S,W,E,X] = Audio processing flags (only shown when enabled):
#                     N=Noise Gate | F=HPF | A=AGC | S=Spectral | W=Wiener
#                     E=Echo Cancel | X=Stream Health OFF (missing X = enabled)
#   R:n       = Stream restart count (shows if >0)
#
# Keyboard Controls (press during operation - no restart needed):
#   MUTE:    't'=TX | 'r'=RX | 'm'=Global
#   AUDIO:   'v'=VAD | ','=Vol- | '.'=Vol+
#   PROCESS: 'n'=Gate | 'f'=HPF | 'a'=AGC | 's'=Spectral | 'w'=Wiener
#            'e'=Echo | 'x'=Stream Health
#   PTT:     'p'=Manual PTT Toggle
#   PLAY:    '1'=Ann1 | '2'=Ann2 | '3'=StationID (if ENABLE_PLAYBACK=true)
#
# For more help, check the README.txt file or enable VERBOSE_LOGGING.
# ============================================================================
